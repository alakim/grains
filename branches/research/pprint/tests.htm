<html>
<head>
<title>PPrint Unit Tests</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<script type="text/javascript" src="../tools/jsUnit.js"></script>
<script type="text/javascript">
	if(typeof(console)=="undefined"){
		console = {
			log:function(){
				var msg = [];
				for(var i=0; i<arguments.length; i++){
					msg.push(arguments[i]);
				}
				out.innerHTML+=msg.join(" ")
					.replace(/&/g, "&amp;")
					.replace(/</g, "&lt;")
					.replace(/>/g, "&gt;")
					.replace(/\r\n/g, "<br>")
					.replace(/\t/g, "&nbsp;&nbsp;&nbsp;&nbsp;")
					+ "<br><hr>";
			}
		};
	}
</script>
<script type="text/javascript" src="pprint.js"></script>
<script type="text/javascript">

new JSUnit.Test("Подключение модуля PPrint", "Configuration").run = function(){
	this.assert(typeof(PPrint), "object");
}

function simpleDocument1(){
	return [
		"<html>  ",
		"	<head>	",
		"		<title>My Document</title>",
		"	</head>",
		"	<body> ",
		"		<h1 class=\"big\">My Document</h1>",
		"	</body>",
		"</html>"
	].join("\r\n");
}

function simpleDocument2(){
	return [
		"<html>  ",
		"	<head>	",
		"		<title>My Document</title>",
		"	</head>",
		"	<body> ",
		"		<h1 class=\"big\">My Document</h1>",
		"		<p>Paragraph</p>",
		"	</body>",
		"</html>"
	].join("\r\n");
}

function freeDocument(){
	return [
		"<html>  ",
		"	<head>	",
		"		<title>My Document</title>",
		"	</head>",
		"	<body> ",
		"		<h1 class=\"big\">My Document</h1>",
		"		<p>Paragraph 1",
		"		<p>Paragraph 2",
		"	</body>",
		"</html>"
	].join("\r\n");
}

new JSUnit.Test("flatDocument", "Formatting").run = function(){
	var html = simpleDocument1();
	
	var flatCode = PPrint.flatDocument(html);
	this.assert(flatCode, "<html><head><title>My Document</title></head><body><h1 class=\"big\">My Document</h1></body></html>");
}

new JSUnit.Test("pretty print 1", "Formatting").run = function(){
	var html = simpleDocument2();
	
	var code = PPrint.formatDocument(html);
	console.log(code);
	this.assert(code, "<html>\r\n\t<head>\r\n\t\t<title>My Document</title>\r\n\t</head>\r\n\t<body>\r\n\t\t<h1 class=\"big\">My Document</h1>\r\n\t\t<p>Paragraph</p>\r\n\t</body>\r\n</html>");
}

new JSUnit.Test("pretty print 2", "Formatting").run = function(){
	var html = freeDocument();
	
	var code = PPrint.formatDocument(html);
	console.log(code);
	this.assert(code, "<html>\r\n\t<head>\r\n\t\t<title>My Document</title>\r\n\t</head>\r\n\t<body>\r\n\t\t<h1 class=\"big\">My Document</h1>\r\n\t\t<p>Paragraph 1\r\n\t\t<p>Paragraph 2\r\n\t</body>\r\n</html>");
}

function init(){
	document.getElementById("versionPanel").innerHTML = PPrint.version;
	JSUnit.init();
}
</script>
</head>
<body onload="init()">
	<h1>PPrint Unit Tests</h1>
	<p>Модуль форматирования документов XML и HTML. Реализует функцию pretty print.</p>
	<p>PPrint v.<span id="versionPanel"></span></p>
	<div id="testContainer" style="display:none;"></div>
	<div id="out"></div>
</body>
</html>