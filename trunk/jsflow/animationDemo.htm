<html>
<head>
<title>JSFlow Animation Demo page</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<script type="text/javascript" src="../html/html.js"></script>
<script type="text/javascript" src="jsflow.js"></script>
<script type="text/javascript">

function $(id){return document.getElementById(id);}

function log(msg){$("out").innerHTML+=msg+"<br>";}

function move(x, y){
	x = x?x:0; y = y?y:0;
	var pos0 = pos();
	return pos({x:pos0.x+=x, y:pos0.y+=y});
}

function pos(v){
	var oo = $("square");
	if(v){
		oo.style.left = v.x+"px";
		oo.style.top = v.y+"px";
	}
	return {
		x: oo.style.left?parseInt(oo.style.left):0,
		y: oo.style.top?parseInt(oo.style.top):0
	};
}

function init(){with(JSFlow){
	sequence(
		function(){
			var go = new Continuation();
			function loop(){
				sequence(
					function(){
						move(2,0);
						(new Continuation())()
					},
					wait(5)
				).run(pos().x>200?go:loop);
			}
			loop();
		}
	).run();

	
}}	


</script>
</head>
<body onload="init()">
	<h1>JSFlow Animation Demo page</h1>
	
	<div id="out"></div>
	<div id="square" style="position:absolute;left:100px;top:100px; width:10px; height:10px; background-color:red;"></div>
</body>
</html>